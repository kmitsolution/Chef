##  Step-by-Step: Create a Template with `chef generate template`

Chef provides CLI tools via **ChefDK** or **Chef Workstation** to scaffold components of a cookbook, including templates.

---

###  Step 1: Create a New Cookbook (If Needed)

If you haven’t created a cookbook yet:

```bash
chef generate cookbook my_cookbook
```

This creates a directory called `my_cookbook` with standard cookbook structure.

---

###  Step 2: Generate a Template File

From inside your cookbook directory:

```bash
chef generate template my_cookbook config.conf
```

This creates a file at:

```
my_cookbook/
├── templates/
│       └── config.conf.erb
```

It also adds a placeholder `template` resource to your `recipes/default.rb` like:

```ruby
template '/tmp/config.conf' do
  source 'config.conf.erb'
end
```



---

###  Step 3: Edit the Template (ERB File)

Open `templates/config.conf.erb` and add dynamic Ruby code:

```erb
# Config file generated by Chef
Port = <%= @port %>

```

---

### Step 4: Set Variables in the Recipe

Edit `recipes/default.rb` to include variables:

```ruby
template '/etc/myapp/config.conf' do
  source 'config.conf.erb'
  variables({
    port: 'testing'
  })
  owner 'root'
  group 'root'
  mode '0644'
end
```

Set node attributes in an attribute file or via role/environment:

```ruby
# attributes/default.rb
default['myapp']['port'] = 8080
```

---

### ▶ Step 5: Run Chef on the Node

Upload the cookbook and run Chef on your node:

```bash
knife cookbook upload my_cookbook
knife bootstrap <node> --run-list 'recipe[my_cookbook]'
```

Or, if testing locally with Chef Zero or Test Kitchen:

```bash
chef-client -z -r 'recipe[my_cookbook]'
```

---

### Summary of Commands

| Command                            | Purpose                                                |
| ---------------------------------- | ------------------------------------------------------ |
| `chef generate cookbook NAME`      | Creates a new cookbook                                 |
| `chef generate template PATH NAME` | Creates a new template in the cookbook                 |
| `template` resource                | Renders and writes the template file to a path         |
| `.erb` file                        | Contains Ruby + plain text for dynamic file generation |

---

Would you like me to scaffold a complete working example for `nginx.conf` or a specific service configuration?
